(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{733:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(4),i=n(8),c=n(2),l=n(1),u=n(740),s=n.n(u);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(e){function t(){var e,n,r,a,o,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,u=new Array(l),s=0;s<l;s++)u[s]=arguments[s];return r=this,n=!(a=(e=h(t)).call.apply(e,[this].concat(u)))||"object"!==p(a)&&"function"!=typeof a?y(r):a,o=y(n),c=null,(i="container")in o?Object.defineProperty(o,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[i]=c,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),n=t,(r=[{key:"componentWillUnmount",value:function(){null!==this.container&&(this.container.destroy(),this.container=null)}},{key:"redraw",value:function(){window.alert("not yet implemented")}},{key:"componentDidUpdate",value:function(){this.redraw()}},{key:"componentDidMount",value:function(){this.redraw()}}])&&f(n.prototype,r),a&&f(n,a),t}(a.a.Component),b=n(9),g=n(11),v=n(12),w=n(48),O="confirm-disable-discovery-modal",E=Object(o.b)(null,(function(e){return{handleDisable:function(){c.a.setBoolSetting(e,"discovery-mode",!1),c.a.hideModal(e)}}}))((function(e){var t=a.a.createElement("form",{id:O,onSubmit:e.handleDisable},a.a.createElement("p",null,Object(l.z)("client.settings.customization.confirm_disable_discovery")));return a.a.createElement(v.a,{title:Object(l.z)("client.settings.customization.discovery"),body:t,footer:a.a.createElement(w.a,{formId:O})})}));Object(g.b)(O,(function(){return a.a.createElement(E,null)}));var j=Object(o.b)((function(e){return{enabled:c.b.boolSetting(e,"discovery-mode")}}),(function(e){return{handleClose:function(){c.a.showModal(e,O)}}}))((function(e){return a.a.createElement(b.b,{condition:e.enabled},a.a.createElement("p",{className:"alerts info with-action"},a.a.createElement("span",null,e.message),a.a.createElement("button",{onClick:e.handleClose,className:"fa fa-times-circle"})))}));function S(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t,n){return t&&k(e.prototype,t),n&&k(e,n),e}function T(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?z(e):t}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var B=600,D=100,K=3;var M=function(e){function t(){return I(this,t),T(this,x(t).apply(this,arguments))}return A(t,e),P(t,[{key:"redraw",value:function(){this.container=function(e,t,n){function r(e){var t=e.budgetDate;return"".concat(t.getFullYear()," - ").concat(t.getMonth())}for(var a={},o=new Map,i=new Map,c=0;c<t.length;c++){var u=t[c],p=r(u);o.set(p,o.get(p)||[0,0,0]);var f=o.get(p);f[0]+=u.amount>0?u.amount:0,f[1]+=u.amount<0?-u.amount:0,f[2]+=u.amount,i.set(p,+u.budgetDate)}var h=Array.from(i);h.sort((function(e,t){return e[1]-t[1]}));var y=[];function d(e,t,n){for(var r=[],i=0;i<h.length;i++){var c=h[i][0];r.push(Object(l.u)(o.get(c)[t]))}var u=[e].concat(r);y.push(u),a[e]=n}var m=Object(l.q)(n);d(Object(l.z)("client.charts.received"),0,m.RECEIVED),d(Object(l.z)("client.charts.spent"),1,m.SPENT),d(Object(l.z)("client.charts.saved"),2,m.SAVED);for(var b=[],g=0;g<h.length;g++){var v=new Date(h[g][1]).toLocaleDateString(void 0,{year:"2-digit",month:"short"});b.push(v)}var w=Math.max(h.length,K)-K,O=h.length,E=Object(l.z)("client.charts.amount");return s.a.generate({bindto:e,data:{columns:y,type:"bar",colors:a},bar:{width:{ratio:.5}},axis:{x:{type:"category",extent:[w,O],categories:b,tick:{fit:!1}},y:{label:E}},grid:{x:{show:!0},y:{show:!0,lines:[{value:0}]}},size:{height:B},subchart:{show:!0,size:{height:D}},zoom:{rescale:!0}})}("#".concat(this.props.chartId),this.props.operations,this.props.theme)}},{key:"render",value:function(){return a.a.createElement("div",{id:this.props.chartId,style:{width:"100%"}})}}]),t}(m),R="",F=function(e){function t(e){var n,r,a,o;return I(this,t),n=T(this,x(t).call(this,e)),r=z(n),o=function(e){n.setState({currency:e.target.value})},(a="handleCurrencyChange")in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,n.state={currency:R},n}return A(t,e),P(t,[{key:"render",value:function(){var e=[],t=[],n=!0,r=!1,o=void 0;try{for(var i,c=this.props.currencyToTransactions[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var u=_(i.value,2),s=u[0],p=u[1];e.push(a.a.createElement("option",{key:s,value:s},s)),this.state.currency!==R&&this.state.currency!==s||t.push(a.a.createElement("div",{key:s},a.a.createElement(b.b,{condition:this.state.currency===R},a.a.createElement("h3",null,s)),a.a.createElement(M,{chartId:"barchart-".concat(s),operations:p,theme:this.props.theme})))}}catch(e){r=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}return a.a.createElement(a.a.Fragment,null,a.a.createElement(j,{message:Object(l.z)("client.charts.differences_all_desc")}),a.a.createElement(b.b,{condition:e.length>1},a.a.createElement("p",null,a.a.createElement("select",{className:"form-element-block",onChange:this.handleCurrencyChange,defaultValue:this.state.currency},a.a.createElement("option",{value:R},Object(l.z)("client.charts.all_currencies")),e))),t)}}]),t}(a.a.Component),V=Object(o.b)((function(e,t){var n=c.b.accountIdsByAccessId(e,t.accessId),r=new Map,a=!0,o=!1,i=void 0;try{for(var l,u=n[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var s,p=l.value,f=c.b.accountById(e,p).currency;r.has(f)||r.set(f,[]);var h=c.b.operationsByAccountId(e,p);(s=r.get(f)).push.apply(s,S(h))}}catch(e){o=!0,i=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw i}}return{currencyToTransactions:r,theme:c.b.setting(e,"theme")}}))(F),Y=n(748);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var W=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),H(this,G(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(t,e),n=t,(r=[{key:"redraw",value:function(){this.container=function(e,t,n,r){if(null!==t){var a=n.slice().sort((function(e,t){return+e.date-+t.date})),o=new Map,i=864e5,c=a.length?+a[0].date:Date.now();c=(c/i|0)*i;for(var u=(Date.now()/i|0)*i;c<=u;c+=i)o.set(I(new Date(c)),0);var s=!0,p=!1,f=void 0;try{for(var h,y=a[Symbol.iterator]();!(s=(h=y.next()).done);s=!0){var d=h.value,m=I(d.date);o.has(m)&&o.set(m,o.get(m)+d.amount)}}catch(e){p=!0,f=e}finally{try{s||null==y.return||y.return()}finally{if(p)throw f}}var b=t.initialBalance,g="Date,Balance\n",v=!0,w=!1,O=void 0;try{for(var E,j=o[Symbol.iterator]();!(v=(E=j.next()).done);v=!0){var S=U(E.value,2),_=S[0];b+=S[1],g+="".concat(_,",").concat(Object(l.u)(b),"\n")}}catch(e){w=!0,O=e}finally{try{v||null==j.return||j.return()}finally{if(w)throw O}}var C=Object(l.p)(r);return new Y.a(document.querySelector(e),g,{color:C.LINES,axisLineColor:C.AXIS,axes:{x:{axisLabelFormatter:function(e){return e.toLocaleDateString(void 0,{year:"2-digit",month:"short"})}}},fillGraph:!0,showRangeSelector:!0,rangeSelectorPlotFillGradientColor:C.LINES,rangeSelectorPlotStrokeColor:C.LINES,dateWindow:[u-15552e6,u],gridLinePattern:[4,2]})}function I(e){return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate())}Object(l.l)("ChartComponent: no account")}("#barchart",this.props.account,this.props.operations,this.props.theme)}},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(j,{message:Object(l.z)("client.charts.balance_desc")}),a.a.createElement("div",{id:"barchart",style:{width:"100%"}}))}}])&&L(n.prototype,r),o&&L(n,o),t}(m),X=n(3),Q=n.n(X);function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e,t,n){return t&&ne(e.prototype,t),n&&ne(e,n),e}function ae(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?oe(e):t}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ce(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ue=function(e){return a.a.createElement("select",{className:"form-element-block",defaultValue:e.defaultValue,onChange:function(t){e.onChange(t.target.value)},id:e.htmlId},a.a.createElement("option",{key:"value",value:"all"},Object(l.z)("client.charts.all_periods")),a.a.createElement("option",{key:"current-month",value:"current-month"},Object(l.z)("client.charts.current_month")),a.a.createElement("option",{key:"last-month",value:"last-month"},Object(l.z)("client.charts.last_month")),a.a.createElement("option",{key:"3-months",value:"3-months"},Object(l.z)("client.charts.three_months")),a.a.createElement("option",{key:"6-months",value:"6-months"},Object(l.z)("client.charts.six_months")))},se=function(e){return a.a.createElement("select",{className:"form-element-block",defaultValue:e.defaultValue,onChange:function(t){e.onChange(t.target.value)}},a.a.createElement("option",{key:"all",value:"all"},Object(l.z)("client.charts.incomes_and_expenses")),a.a.createElement("option",{key:"positive",value:"positive"},Object(l.z)("client.charts.incomes")),a.a.createElement("option",{key:"negative",value:"negative"},Object(l.z)("client.charts.expenses")))},pe=function(e){function t(){return te(this,t),ae(this,ie(t).apply(this,arguments))}return ce(t,e),re(t,[{key:"hide",value:function(){this.container.hide()}},{key:"show",value:function(){this.container.show()}},{key:"render",value:function(){return a.a.createElement("div",{id:this.props.chartId})}}]),t}(m);pe.propTypes={chartId:Q.a.string.isRequired};var fe=function(e){function t(){return te(this,t),ae(this,ie(t).apply(this,arguments))}return ce(t,e),re(t,[{key:"datekey",value:function(e){var t=e.budgetDate;return"".concat(t.getFullYear(),"-").concat(t.getMonth())}},{key:"redraw",value:function(){var e=new Map,t={},n=new Map,r=!0,a=!1,o=void 0;try{for(var i,c=this.props.operations[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var u=i.value,p=this.props.getCategoryById(u.categoryId);e.set(p.label,e.get(p.label)||{});var f=e.get(p.label),h=this.datekey(u),y=this.props.invertSign?-u.amount:u.amount;(f[h]=f[h]||[]).push(y),n.set(h,+u.budgetDate),t[p.label]=t[p.label]||p.color}}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}var d=Array.from(n);d.sort((function(e,t){return e[1]-t[1]}));var m=[],b=!0,g=!1,v=void 0;try{for(var w,O=e.keys()[Symbol.iterator]();!(b=(w=O.next()).done);b=!0){for(var E=w.value,j=[],S=0;S<d.length;S++){var _=d[S][0],C=e.get(E)[_]=e.get(E)[_]||[];j.push(Object(l.u)(C.reduce((function(e,t){return e+t}),0)))}j=[E].concat(j),m.push(j)}}catch(e){g=!0,v=e}finally{try{b||null==O.return||O.return()}finally{if(g)throw v}}for(var I,k=[],P=0;P<d.length;P++){var T=new Date(d[P][1]).toLocaleDateString(void 0,{year:"2-digit",month:"short"});k.push(T)}switch(this.props.period){case"current-month":I=[Math.max(0,k.length-1),k.length];break;case"last-month":I=[Math.max(0,k.length-2),Math.max(0,k.length-1)];break;case"3-months":I=[Math.max(0,k.length-3),k.length];break;default:I=[Math.max(0,k.length-6),k.length]}this.container=s.a.generate({bindto:"#".concat(this.props.chartId),size:{height:600},data:{columns:m,type:"bar",colors:t},bar:{width:{ratio:.5}},axis:{x:{type:"category",categories:k,tick:{fit:!1},extent:I},y:{label:Object(l.z)("client.charts.amount")}},grid:{x:{show:!0},y:{show:!0,lines:[{value:0}]}},subchart:{show:!0,size:{height:80}},transition:{duration:0},zoom:{rescale:!0}})}}]),t}(pe);fe.propTypes={getCategoryById:Q.a.func.isRequired,operations:Q.a.array.isRequired,invertSign:Q.a.bool.isRequired};var he=function(e){function t(){return te(this,t),ae(this,ie(t).apply(this,arguments))}return ce(t,e),re(t,[{key:"redraw",value:function(){var e=new Map,t=!0,n=!1,r=void 0;try{for(var a,o=this.props.operations[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var i=a.value,c=i.categoryId;e.has(c)||e.set(c,[]),e.get(c).push(i.amount)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}var u=[],p={},f=!0,h=!1,y=void 0;try{for(var d,m=e[Symbol.iterator]();!(f=(d=m.next()).done);f=!0){var b=$(d.value,2),g=b[0],v=b[1],w=this.props.getCategoryById(g);u.push([w.label].concat(v)),p[w.label]=w.color}}catch(e){h=!0,y=e}finally{try{f||null==m.return||m.return()}finally{if(h)throw y}}this.container=s.a.generate({bindto:"#".concat(this.props.chartId),data:{columns:u,type:"pie",colors:p},tooltip:{format:{value:function(e,t){return"".concat(Object(l.u)(100*t),"% (").concat(Math.abs(Object(l.u)(e)),")")}}}})}}]),t}(pe);he.propTypes={getCategoryById:Q.a.func.isRequired,operations:Q.a.array.isRequired};var ye=function(e){function t(){var e,n;te(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Z(oe(n=ae(this,(e=ie(t)).call.apply(e,[this].concat(o)))),"ref",a.a.createRef()),Z(oe(n),"show",(function(){n.ref.current.show()})),Z(oe(n),"hide",(function(){n.ref.current.hide()})),Z(oe(n),"render",(function(){return a.a.createElement("div",null,a.a.createElement("h3",null,a.a.createElement("span",{className:"tooltipped tooltipped-ne tooltipped-multiline","aria-label":Object(l.z)(n.props.helpKey)},a.a.createElement("span",{className:"fa fa-question-circle clickable"})),Object(l.z)(n.props.titleKey)),a.a.createElement(he,{chartId:n.props.chartId,getCategoryById:n.props.getCategoryById,operations:n.props.ops,ref:n.ref}))})),n}return ce(t,e),t}(a.a.Component),de=function(e){function t(){var e,n;te(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Z(oe(n=ae(this,(e=ie(t)).call.apply(e,[this].concat(o)))),"state",{displayRawIncomeHelp:!1,displayRawSpendingsHelp:!1,displayNetIncomeHelp:!1,displayNetSpendingsHelp:!1}),Z(oe(n),"refRawIncome",a.a.createRef()),Z(oe(n),"refRawSpendings",a.a.createRef()),Z(oe(n),"refNetIncome",a.a.createRef()),Z(oe(n),"refNetSpendings",a.a.createRef()),Z(oe(n),"show",(function(){n.refRawIncome.current.show(),n.refRawSpendings.current.show(),n.refNetIncome.current.show(),n.refNetSpendings.current.show()})),Z(oe(n),"hide",(function(){n.refRawIncome.current.hide(),n.refRawSpendings.current.hide(),n.refNetIncome.current.hide(),n.refNetSpendings.current.hide()})),Z(oe(n),"render",(function(){return a.a.createElement("div",{className:"pie-charts"},a.a.createElement(ye,{chartId:"rawIncomePie",helpKey:"client.charts.help_raw_income",titleKey:"client.charts.raw_income",getCategoryById:n.props.getCategoryById,ops:n.props.rawIncomeOps,ref:n.refRawIncome}),a.a.createElement(ye,{chartId:"rawSpendingsPie",helpKey:"client.charts.help_raw_spendings",titleKey:"client.charts.raw_spendings",getCategoryById:n.props.getCategoryById,ops:n.props.rawSpendingOps,ref:n.refRawSpendings}),a.a.createElement(ye,{chartId:"netIncomePie",helpKey:"client.charts.help_net_income",titleKey:"client.charts.net_income",getCategoryById:n.props.getCategoryById,ops:n.props.netIncomeOps,ref:n.refNetIncome}),a.a.createElement(ye,{chartId:"netSpendingsPie",helpKey:"client.charts.help_net_spendings",titleKey:"client.charts.net_spendings",getCategoryById:n.props.getCategoryById,ops:n.props.netSpendingOps,ref:n.refNetSpendings}))})),n}return ce(t,e),t}(a.a.Component),me=function(e){function t(e){var n;return te(this,t),Z(oe(n=ae(this,ie(t).call(this,e))),"refBarchart",a.a.createRef()),Z(oe(n),"refPiecharts",a.a.createRef()),Z(oe(n),"handleChangePeriod",(function(e){n.setState({period:e})})),Z(oe(n),"handleChangeAmountKind",(function(e){n.setState({amountKind:e})})),Z(oe(n),"createPeriodFilter",(function(e){var t,n=new Date,r=n.getFullYear(),a=n.getMonth();switch(e){case"all":return function(){return!0};case"current-month":return function(e){return e.getMonth()===a&&e.getFullYear()===r};case"last-month":return t=a>0?a-1:11,r=a>0?r:r-1,function(e){return e.getMonth()===t&&e.getFullYear()===r};case"3-months":return a>=3?(t=a-3,function(e){return e.getMonth()>=t&&e.getFullYear()===r}):(t=(a+9)%12,function(e){return e.getMonth()>=t&&e.getFullYear()===r-1||e.getMonth()<=a&&e.getFullYear()===r});case"6-months":return a>=6?(t=a-6,function(e){return e.getMonth()>=t&&e.getFullYear()===r}):(t=(a+6)%12,function(e){return e.getMonth()>=t&&e.getFullYear()===r-1||e.getMonth()<=a&&e.getFullYear()===r});default:Object(l.g)(!1,"unexpected option for date filter")}})),Z(oe(n),"handleShowAll",(function(){n.refBarchart.current.show(),n.refPiecharts.current.show()})),Z(oe(n),"handleHideAll",(function(){n.refBarchart.current.hide(),n.refPiecharts.current.hide()})),n.state={amountKind:e.defaultAmountKind,period:e.defaultPeriod},n}return ce(t,e),re(t,[{key:"render",value:function(){var e=this.props.operations,t=this.createPeriodFilter(this.state.period),n=e.filter((function(e){return t(e.budgetDate)})),r="positive"===this.state.amountKind,o="negative"===this.state.amountKind;o?n=n.filter((function(e){return e.amount<0})):r&&(n=n.filter((function(e){return e.amount>0})));var i=null;if(r||o)i=a.a.createElement(he,{chartId:"piechart",getCategoryById:this.props.getCategoryById,operations:n,ref:this.refPiecharts});else{var c=n.filter((function(e){return e.amount>0})),u=n.filter((function(e){return e.amount<0})),s=new Map,p=!0,f=!1,h=void 0;try{for(var y,d=n[Symbol.iterator]();!(p=(y=d.next()).done);p=!0){var m=y.value;s.has(m.categoryId)||s.set(m.categoryId,[]),s.get(m.categoryId).push(m)}}catch(e){f=!0,h=e}finally{try{p||null==d.return||d.return()}finally{if(f)throw h}}var b=[],g=[],v=!0,w=!1,O=void 0;try{for(var E,S=s.values()[Symbol.iterator]();!(v=(E=S.next()).done);v=!0){var _=E.value;_.reduce((function(e,t){return e+t.amount}),0)>0?b=b.concat(_):g=g.concat(_)}}catch(e){w=!0,O=e}finally{try{v||null==S.return||S.return()}finally{if(w)throw O}}i=a.a.createElement(de,{getCategoryById:this.props.getCategoryById,rawIncomeOps:c,netIncomeOps:b,rawSpendingOps:u,netSpendingOps:g,ref:this.refPiecharts})}return a.a.createElement(a.a.Fragment,null,a.a.createElement(j,{message:Object(l.z)("client.charts.by_category_desc")}),a.a.createElement("form",null,a.a.createElement("p",null,a.a.createElement("label",null,Object(l.z)("client.charts.amount_type")),a.a.createElement(se,{defaultValue:this.state.amountKind,onChange:this.handleChangeAmountKind})),a.a.createElement("p",null,a.a.createElement("label",{htmlFor:"period"},Object(l.z)("client.charts.period")),a.a.createElement(ue,{defaultValue:this.props.defaultPeriod,onChange:this.handleChangePeriod,htmlId:"period"})),a.a.createElement("div",null,a.a.createElement("label",null,Object(l.z)("client.menu.categories")),a.a.createElement("p",{className:"buttons-group",role:"group","aria-label":"Show/Hide categories"},a.a.createElement("button",{type:"button",className:"btn",onClick:this.handleHideAll},Object(l.z)("client.general.unselect_all")),a.a.createElement("button",{type:"button",className:"btn",onClick:this.handleShowAll},Object(l.z)("client.general.select_all"))))),a.a.createElement(fe,{operations:e,getCategoryById:this.props.getCategoryById,invertSign:o,chartId:"barchart",ref:this.refBarchart,period:this.state.period}),i)}}]),t}(a.a.Component),be=Object(o.b)((function(e){return{defaultAmountKind:c.b.setting(e,"default-chart-type"),defaultPeriod:c.b.setting(e,"default-chart-period"),getCategoryById:function(t){return c.b.categoryById(e,t)}}}))(me);function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Se=Object(o.b)((function(e){return{amountKind:c.b.setting(e,"default-chart-type"),displayType:c.b.setting(e,"default-chart-display-type"),period:c.b.setting(e,"default-chart-period")}}),(function(e){return{setAmountKind:function(t){c.a.setSetting(e,"default-chart-type",t)},setDisplayType:function(t){c.a.setSetting(e,"default-chart-display-type",t)},setPeriod:function(t){c.a.setSetting(e,"default-chart-period",t)},handleClose:function(){c.a.hideModal(e)}}}))(function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return r=this,a=(e=we(t)).call.apply(e,[this].concat(i)),n=!a||"object"!==ge(a)&&"function"!=typeof a?Oe(r):a,je(Oe(n),"state",{isSubmitDisabled:!0,amountKind:n.props.amountKind,displayType:n.props.displayType,period:n.props.period}),je(Oe(n),"handleSubmit",(function(){n.state.amountKind!==n.props.amountKind&&n.props.setAmountKind(n.state.amountKind),n.state.displayType!==n.props.displayType&&n.props.setDisplayType(n.state.displayType),n.state.period!==n.props.period&&n.props.setPeriod(n.state.period),n.props.handleClose()})),je(Oe(n),"handleDisplayTypeChange",(function(e){n.setState({displayType:e.target.value})})),je(Oe(n),"handlePeriodChange",(function(e){n.setState({period:e})})),je(Oe(n),"handleChangeAmountKind",(function(e){n.setState({amountKind:e})})),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(t,e),n=t,(r=[{key:"isSubmitDisabled",value:function(){return this.state.amountKind===this.props.amountKind&&this.state.displayType===this.props.displayType&&this.state.period===this.props.period}},{key:"render",value:function(){var e=a.a.createElement("form",{id:"charts-default-params",onSubmit:this.handleSubmit},a.a.createElement("div",{className:"cols-with-label"},a.a.createElement("label",{htmlFor:"defaultDisplayType"},Object(l.z)("client.charts.default_display")),a.a.createElement("select",{className:"form-element-block",id:"defaultDisplayType",onChange:this.handleDisplayTypeChange,defaultValue:this.state.displayType},a.a.createElement("option",{value:"all"},Object(l.z)("client.charts.by_category")),a.a.createElement("option",{value:"balance"},Object(l.z)("client.charts.balance")),a.a.createElement("option",{value:"earnings"},Object(l.z)("client.charts.differences_all")))),a.a.createElement("h5",null,Object(l.z)("client.charts.category_chart")),a.a.createElement("div",{className:"cols-with-label",id:"default-params"},a.a.createElement("label",null,Object(l.z)("client.charts.default_amount_type")),a.a.createElement(se,{defaultValue:this.state.amountKind,onChange:this.handleChangeAmountKind})),a.a.createElement("div",{className:"cols-with-label"},a.a.createElement("label",{htmlFor:"defaultChartPeriod"},Object(l.z)("client.charts.default_period")),a.a.createElement(ue,{defaultValue:this.state.period,onChange:this.handlePeriodChange,htmlId:"defaultChartPeriod"}))),t=a.a.createElement(w.a,{isSubmitDisabled:this.isSubmitDisabled(),formId:"charts-default-params"});return a.a.createElement(v.a,{title:Object(l.z)("client.general.default_parameters"),body:e,footer:t})}}])&&ve(n.prototype,r),o&&ve(n,o),t}(a.a.Component));Object(g.b)("charts-default-params",(function(){return a.a.createElement(Se,null)}));var _e=n(62),Ce=n(19);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xe(e,t){return(xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ae=function(e){function t(){var e,n,r,a,o,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,u=new Array(l),s=0;s<l;s++)u[s]=arguments[s];return r=this,a=(e=Te(t)).call.apply(e,[this].concat(u)),n=!a||"object"!==Ie(a)&&"function"!=typeof a?ze(r):a,o=ze(n),c=function(e){var t=e.target.value;n.props.location.pathname!==t&&n.props.history.push(t)},(i="handleSelectorChange")in o?Object.defineProperty(o,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[i]=c,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xe(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=[],t=[],n=[],r=!0,o=!1,i=void 0;try{for(var c,l=this.props.tabs[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var u=ke(c.value,2),s=u[0],p=u[1];e.push(a.a.createElement(_e.b,{key:s,path:s,component:p.component})),t.push(a.a.createElement("li",{key:s},a.a.createElement(Ce.c,{activeClassName:"active",to:s},p.name))),n.push(a.a.createElement("option",{key:s,value:s},p.name))}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"tabs-container-selector"},a.a.createElement("ul",null,t),a.a.createElement("select",{className:"form-element-block",value:this.props.selectedTab,onChange:this.handleSelectorChange},n)),a.a.createElement("div",{className:"tab-content"},a.a.createElement(_e.d,null,e,a.a.createElement(_e.a,{to:this.props.defaultTab,push:!1}))))}}])&&Pe(n.prototype,r),o&&Pe(n,o),t}(a.a.Component);function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ke(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fe=Object(o.b)(null,(function(e){return{handleClick:function(){c.a.showModal(e,"charts-default-params")}}}))((function(e){return a.a.createElement("button",{className:"btn",onClick:e.handleClick},a.a.createElement("span",{className:"fa fa-cog"}),a.a.createElement("span",null,Object(l.z)("client.general.default_parameters")))})),Ve=function(e){function t(){var e,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];return r=this,o=(e=De(t)).call.apply(e,[this].concat(c)),n=!o||"object"!==Ne(o)&&"function"!=typeof o?Ke(r):o,Re(Ke(n),"makeAllChart",(function(){return a.a.createElement(be,{operations:n.props.operations})})),Re(Ke(n),"makeBalanceChart",(function(){return a.a.createElement(W,{operations:n.props.operations,account:n.props.account,theme:n.props.theme})})),Re(Ke(n),"makePosNegChart",(function(){return a.a.createElement(V,{accessId:n.props.account.accessId})})),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props.account.id,t=new Map;t.set(i.a.charts.url("all",e),{name:Object(l.z)("client.charts.by_category"),component:this.makeAllChart}),t.set(i.a.charts.url("balance",e),{name:Object(l.z)("client.charts.balance"),component:this.makeBalanceChart}),t.set(i.a.charts.url("earnings",e),{name:Object(l.z)("client.charts.differences_all"),component:this.makePosNegChart});var n=this.props.defaultDisplay;return a.a.createElement("div",{className:"charts"},a.a.createElement("p",{className:"buttons-toolbar"},a.a.createElement(Fe,null)),a.a.createElement(Ae,{tabs:t,defaultTab:i.a.charts.url(n,e),selectedTab:this.props.location.pathname,history:this.props.history,location:this.props.location}))}}])&&Be(n.prototype,r),o&&Be(n,o),t}(a.a.Component),Ye=Object(o.b)((function(e,t){var n=i.a.charts.accountId(t.match),r=c.b.accountById(e,n),a=c.b.operationsByAccountId(e,n);return{defaultDisplay:c.b.setting(e,"default-chart-display-type"),account:r,operations:a,theme:c.b.setting(e,"theme")}}))(Ve);t.default=Ye}}]);